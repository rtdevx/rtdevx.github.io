{{ if .Params.showPagination | default (.Site.Params.article.showPagination | default true) }}

  {{/* Build a global list of all posts in the "posts" section */}}
  {{ $all := sort (where (where site.RegularPages "Section" "posts") "Params.externalUrl" "==" nil) "Date" "desc" }}
  {{ $current := . }}
  {{ $index := -1 }}

  {{/* Find the index of the current page */}}
  {{ range $i, $p := $all }}
    {{ if eq $p $current }}
      {{ $index = $i }}
    {{ end }}
  {{ end }}

  {{/* Only proceed if the current page is actually in the posts list */}}
  {{ if ge $index 0 }}
    {{/* Compute global prev/next safely */}}
    {{ $lastIndex := sub (len $all) 1 }}
    {{ $prev := cond (gt (add $index 1) $lastIndex) nil (index $all (add $index 1)) }}
    {{ $next := cond (lt (sub $index 1) 0) nil (index $all (sub $index 1)) }}

    {{/* Respect invertPagination setting */}}
    {{ if .Params.invertPagination | default (.Site.Params.article.invertPagination | default false) }}
      {{ $tmp := $next }}
      {{ $next = $prev }}
      {{ $prev = $tmp }}
    {{ end }}

    {{ if or $next $prev }}
      <div class="pt-8">
        <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
        <div class="flex justify-between pt-3">

          <span>
            {{ if $prev }}
              <a class="group flex" href="{{ $prev.Permalink }}">
                <span
                  class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                  ><span class="ltr:inline rtl:hidden">&larr;</span
                  ><span class="ltr:hidden rtl:inline">&rarr;</span></span
                >
                <span class="flex flex-col">
                  <span
                    class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                    >{{ $prev.Title | emojify }}</span
                  >
                  <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                    {{ if .Params.showDate | default (.Site.Params.article.showDate | default true) }}
                      {{ partial "meta/date.html" $prev.Date }}
                    {{ end }}
                  </span>
                </span>
              </a>
            {{ end }}
          </span>

          <span>
            {{ if $next }}
              <a class="group flex text-right" href="{{ $next.Permalink }}">
                <span class="flex flex-col">
                  <span
                    class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                    >{{ $next.Title | emojify }}</span
                  >
                  <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                    {{ if .Params.showDate | default (.Site.Params.article.showDate | default true) }}
                      {{ partial "meta/date.html" $next.Date }}
                    {{ end }}
                  </span>
                </span>
                <span
                  class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[-2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                  ><span class="ltr:inline rtl:hidden">&rarr;</span
                  ><span class="ltr:hidden rtl:inline">&larr;</span></span
                >
              </a>
            {{ end }}
          </span>

        </div>
      </div>
    {{ end }}
  {{ end }}

{{ end }}